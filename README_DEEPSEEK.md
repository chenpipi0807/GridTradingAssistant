# GridTradingAssistant DeepSeek集成使用说明 (V3.1)

## 功能概述

本次更新为GridTradingAssistant添加了DeepSeek AI对话功能，主要包括：

1. 与DeepSeek大模型进行对话交流
2. 支持多种模型选择（DeepSeek-R1、DeepSeek Chat、DeepSeek Coder）
3. 支持上传本地股票数据文件进行分析
4. 支持多轮对话和历史会话管理
5. 集成枢纽点策略分析建议
6. 优化的消息发送功能，支持回车键和发送按钮
7. 实时反馈和加载状态显示

## 最新更新 (2025-05-25)

1. **消息发送体验全面升级**：
   - 支持通过发送按钮和回车键发送消息
   - 发送消息时立即显示用户输入，提供即时反馈
   - 添加美观的消息加载动画提示

2. **错误处理增强**：
   - 修复了多个None值相关的错误
   - 改进了错误处理流程，确保更稳定的用户体验
   - 提供更清晰的错误提示信息

3. **界面优化**：
   - 添加按钮发送状态的视觉反馈
   - 改进了消息布局和样式
   - 添加了高对比度暗色主题

## 使用方法

### 启动应用

1. 确保已安装所有依赖：`pip install -r requirements.txt`
2. 运行主应用：`python app.py`
3. 在浏览器中访问：`http://localhost:8050`

### DeepSeek对话功能

1. 点击顶部的“DeepSeek对话”标签页进入AI对话界面
2. 首次使用需在左侧面板输入DeepSeek API密钥并点击“保存”
3. 选择合适的模型（默认为DeepSeek-R1推理增强模型）
4. 在对话框中输入问题，点击“发送”按钮或按回车键发送消息

### 上传股票数据文件

1. 在DeepSeek对话标签页的左侧面板，使用"上传数据文件"功能
2. 可以拖放或点击选择文件上传
3. 上传的文件将作为上下文发送给DeepSeek模型，帮助分析

### 历史会话管理

1. 每次对话会自动保存到本地
2. 可以在左侧面板的"历史会话"列表中查看和管理历史对话
3. 点击"加载"可以继续之前的对话，点击"删除"可以移除不需要的会话
4. 点击"新建会话"可以开始一个全新的对话

### 枢轴点策略分析

在对话中可以询问关于枢轴点策略的问题，例如：
- "请分析这支股票的枢轴点"
- "如何利用枢轴点制定网格交易策略"
- "基于上传的数据计算枢轴点和支撑/阻力位"

## 文件结构

- `app.py`: 主应用入口，集成了DeepSeek对话标签页
- `deepseek_api.py`: DeepSeek API调用模块
- `deepseek_ui.py`: DeepSeek对话界面实现
- `temp/`: 临时数据文件存储目录
- `chattemp/`: 对话历史缓存目录
- `key.txt`: API密钥存储文件（首次使用时会自动创建）

## 注意事项

1. API密钥仅需输入一次，会保存在本地的key.txt文件中
2. 上传的文件大小有限制，请确保单个文件不超过10MB
3. 对话历史会自动保存在本地，可以随时继续之前的对话
4. 如需清除所有历史记录，可以删除chattemp目录下的所有文件

## 故障排除

1. 如果遇到API连接问题，请检查API密钥是否正确
2. 如果上传文件失败，请检查文件格式和大小
3. 如果对话没有响应，可能是网络问题或API限制，请稍后重试
4. 如果应用无法启动，请检查依赖是否安装完整
