# 网格交易大师V5 (GTA)

一款功能强大的股票数据观测、分析和AI小助手工具，基于中间价理念，帮助投资者快速分析股票价格走势、振幅变化及制定网格交易策略。

## 主要功能

### 市场分析工具

- **历史价格数据抓取**：自动获取股票的开盘价、收盘价、最高价、最低价和中间价数据
- **中间价分析**：计算并展示基于(最高价+最低价)/2的中间价指标与振幅分析
- **中间价动量指标(MPMI)**：基于中间价的动量指标，类似MACD但以中间价为基础，自动标记金叉和死叉信号
- **可视化图表**：K线图与中间价曲线结合展示，支持图表缩放和数据细节查看

### DeepSeek AI智能助手

- **AI交易咨询**：与DeepSeek R1大模型进行交易策略讨论和市场分析
- **流式响应**：快速获取AI回复，实现更流畅的对话体验
- **数据上传与分析**：可选择性使用当前股票数据进行深度分析
- **快速问题模板**：提供常用分析问题模板，一键提问快速获取见解
- **枢纽点策略支持**：支持计算枢纽点和支撑/阻力位，辅助网格交易决策

![image](https://github.com/user-attachments/assets/d5abda46-fa8f-4ac5-9f1d-4331b8ffaa56)

![微信截图_20250615002019](https://github.com/user-attachments/assets/c8b760db-4413-4489-9de0-2c54668debc1)

![微信截图_20250615002043](https://github.com/user-attachments/assets/aa655f2c-b49d-49d6-ab6d-3c6eef41b898)


## 更新日志

- 2025年7月1日
  - 给振幅加了一些新的观测星标用来统计连续三天振幅的缩量（红色星标代表振幅持续收缩中间价上涨，绿色相反，黄色代表中间价在波动）

- 2025年6月18日
  - 把MPMI加回来了，我发现MPMI和ATR组合着用似乎能看出一些门道

- 2025年6月15日
  - 新增ATR指标分析功能，展示ATR值和ATR指标线，帮助用户了解股票波动性
  - 升级DeepSeek智能助手界面和功能
    - 简化为仅支持DeepSeek R1模型，优化性能
    - 实现流式响应，提高对话交互体验
    - 添加快速问题模板，包括ATR指标分析等
    - 增加股票数据使用开关，让用户可以选择是否传递股票数据
    - 修复股票名称和代码显示问题
  - 优化行情分析功能
    - 默认查询天数调整为60天
    - 改进UI样式和交互体验
  - 升级应用版本为V5

- 2025年6月12日
  - 新增开盘价与中间价差值百分比观测功能
  - 优化计算公式：当中间价高于开盘价时差值为正（红色），低于开盘价时差值为负（绿色）
  - 添加差值在图表、数据表格和摘要卡片中的展示
  - 去除图表多余标题，精简界面
  - 升级应用版本为V4

- 2025年6月4日
  - 新增中间价动量指标(MPMI)，类似MACD但基于中间价计算
  - MPMI指标始终显示，包含指标线、信号线、柱状图及金叉/死叉标记
  - 调整默认股票代码为301536,可以在favorite_stocks.json中修改常用股票
  - 调整默认日期范围为30天
  - 增加60天和120天的选项

- 2025年5月25日
  - 新增Deepseek的AI对话功能，须自行注册api并填入key

- 2025年5月15日
  - 新增成交量与K线图


## 安装指南

1. 克隆本仓库
2. 安装依赖项：
```
pip install -r requirements.txt
```
3. 运行主应用：
```
python app.py
```
4. 在浏览器中访问：`http://localhost:8050`

**注意**：使用DeepSeek AI功能需要注册DeepSeek API密钥，并在首次使用时在应用中输入。

## 数据源

本工具当前支持以下数据源：
- **东方财富API**（默认）：无需注册，自动获取A股数据

## 使用说明

### 市场分析工具

1. 在搜索框中输入股票代码或名称（例如：603019 或 中科曙光）
2. 从下拉菜单中选择日期范围（支持多种预设时间段和自定义区间）
3. 点击“查询”按钮获取并分析股票数据
4. 在主界面查看K线图、中间价曲线和振幅分析
5. 通过数据表格查看详细的交易数据和技术指标
6. 系统会自动生成基于预设阈值的交易预警信息

### DeepSeek AI对话功能

1. 点击顶部的"DeepSeek对话"标签页进入AI对话界面
2. 首次使用需在左侧面板输入DeepSeek API密钥并点击"保存"
3. 在对话框中输入问题，通过点击"发送"按钮或直接按回车键发送消息
4. 使用快速问题按钮可一键提问常见分析需求
5. 当加载了股票数据后，可通过开关控制是否在对话中使用当前股票数据
6. 如需清空当前对话，点击"新对话"按钮

#### 枢纽点策略分析示例问题

- “请分析这支股票的枢纽点”
- “如何利用枢纽点制定网格交易策略”
- “基于上传的数据计算枢纽点和支撑/阻力位”

## 项目结构

### 核心文件

- `app.py`: 主应用入口和Dash界面实现
- `data_fetcher.py`: 股票数据获取模块，支持多种数据源接口
- `data_processor.py`: 数据处理和技术指标计算模块
- `visualizer.py`: 数据可视化和图表生成模块
- `strategy.py`: 交易策略实现和回测框架
- `utils.py`: 通用工具函数和辅助方法

### DeepSeek AI模块

- `deepseek_api.py`: DeepSeek API调用模块，处理与AI模型的交互
- `deepseek_ui.py`: DeepSeek对话界面实现，提供对话组件和回调函数
- `chattemp/`: 对话历史缓存目录
- `key.txt`: API密钥存储文件（首次使用时会自动创建）

### 其他资源

- `assets/`: 静态资源目录，包含网站图标、CSS样式等资源
- `temp/`: 临时数据文件存储目录

## 技术特点

- **现代化UI**：采用Dash和Bootstrap组件构建直观易用的界面
- **响应式设计**：适配不同屏幕尺寸，支持移动设备访问
- **实时数据处理**：高效的数据计算和展示流程
- **交互式图表**：支持放大缩小、数据选择和详情查看

